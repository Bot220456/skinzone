<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡¶ú‡¶æ‡¶´‡¶∞‡¶æ‡¶® ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü‡¶¨‡¶ü</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: linear-gradient(135deg, #fdfbfb, #ebedee);
    }
    .chatbox {
      max-width: 420px;
      margin: auto;
      background: rgba(255,255,255,0.98);
      height: 90vh;
      display: flex;
      flex-direction: column;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
      position: relative;
    }
    .messages {
      flex: 1;
      padding: 12px;
      overflow-y: auto;
      scroll-behavior: smooth;
    }
    .msg {
      margin: 8px 0;
      padding: 10px 14px;
      border-radius: 12px;
      max-width: 80%;
      display: inline-block;
      font-size: 15px;
      line-height: 1.5;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.4s forwards;
      white-space: pre-line;
    }
    .bot { background: #f4f4f4; text-align: left; float: left; clear: both; }
    .user { background: linear-gradient(135deg, #4a00e0, #8e2de2); color: #fff; text-align: right; float: right; clear: both; }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .options button {
      margin: 6px;
      padding: 12px 20px;
      border: none;
      border-radius: 25px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.12);
      transition: transform 0.25s ease, box-shadow 0.3s ease, opacity 0.3s;
      display: block;
      width: 90%;
    }
    .options button:nth-child(1) { background: linear-gradient(45deg, #8e2de2, #4a00e0); }
    .options button:nth-child(2) { background: linear-gradient(45deg, #f7971e, #ffd200); color: #222; }
    .options button:nth-child(3) { background: linear-gradient(45deg, #0f2027, #203a43, #2c5364); }
    .options button:hover { transform: scale(1.05); box-shadow: 0 6px 15px rgba(0,0,0,0.25); }
    .selected { opacity: 1 !important; transform: scale(1.05); }
    .dimmed { opacity: 0.4; }
    #confirmBtn {
      display: block;
      margin: 15px auto;
      padding: 14px 24px;
      border: none;
      border-radius: 30px;
      background: linear-gradient(135deg, #d4af37, #f7e27c);
      color: #222;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(212,175,55,0.3);
    }
    input {
      width: 90%;
      padding: 10px;
      margin: 5px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      outline: none;
      font-size: 14px;
    }
    .invoice {
      background: #fff;
      border-radius: 12px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      font-size: 15px;
      line-height: 1.6;
    }
    .invoice h3 {
      margin-top: 0;
      color: #4a00e0;
      font-size: 17px;
      border-bottom: 1px solid #ddd;
      padding-bottom: 6px;
    }
  </style>
</head>
<body>
  <div class="chatbox">
    <div class="messages" id="messages"></div>
  </div>

  <script>
    const messages = document.getElementById("messages");
    let selectedOffer = "";
    let orderConfirmed = false;

    const offerPrices = {
      "‡ßß‡¶™‡¶ø‡¶∏ ‡¶ú‡¶æ‡¶´‡¶∞‡¶æ‡¶® ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡ß©‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ": 350,
      "‡ß®‡¶™‡¶ø‡¶∏ ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡ß´‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶∏‡¶æ‡¶•‡ßá ‡ßß‡¶ü‡¶ø ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡¶´‡ßç‡¶∞‡ßÄ)": 550,
      "‡ß©‡¶™‡¶ø‡¶∏ ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡ßÆ‡ß´‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ (‡¶∏‡¶æ‡¶•‡ßá ‡ßß‡¶ü‡¶ø ‡¶®‡¶æ‡¶á‡¶ü ‡¶ï‡ßç‡¶∞‡¶ø‡¶Æ ‡¶´‡ßç‡¶∞‡ßÄ)": 850
    };

    function addMessage(text, sender="bot") {
      const div = document.createElement("div");
      div.className = `msg ${sender}`;
      div.innerText = text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    function addOptions(options, removable=true) {
      const existing = document.querySelector(".options");
      if(existing) existing.remove();
      const div = document.createElement("div");
      div.className = "options bot";
      options.forEach(opt => {
        const btn = document.createElement("button");
        btn.innerText = opt;
        btn.onclick = () => selectOption(opt, div, removable);
        div.appendChild(btn);
      });
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    function selectOption(opt, optionsDiv, removable) {
      if(orderConfirmed) return;
      addMessage(opt, "user");
      selectedOffer = opt;
      if(removable && optionsDiv) optionsDiv.remove();

      if(opt === "‡¶õ‡ßá‡¶≤‡ßá" || opt === "‡¶Æ‡ßá‡ßü‡ßá") {
        setTimeout(() => {
          addMessage("‚ú® ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡¶™‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶Ö‡¶´‡¶æ‡¶∞ ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®:\nüëâ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶õ‡¶®‡ßç‡¶¶‡ßá‡¶∞ ‡¶Ö‡¶´‡¶æ‡¶∞‡¶ü‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®:");
          addOptions(Object.keys(offerPrices), false);
        }, 500);
      }
      if(opt.includes("‡¶™‡¶ø‡¶∏")) {
        const allBtns = optionsDiv.querySelectorAll("button");
        allBtns.forEach(btn => {
          if(btn.innerText === opt) {
            btn.classList.add("selected");
            btn.classList.remove("dimmed");
          } else {
            btn.classList.add("dimmed");
            btn.classList.remove("selected");
          }
        });
        setTimeout(() => {
          addMessage("üì¶ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡¶ø‡¶®:");
          orderForm();
        }, 500);
      }
    }

    function orderForm() {
      const existing = document.getElementById("orderForm");
      if(existing) existing.remove();
      const div = document.createElement("div");
      div.className = "bot";
      div.id = "orderForm";
      div.innerHTML = `
        <input type='text' id='name' placeholder='üë§ ‡¶®‡¶æ‡¶Æ'><br>
        <input type='number' id='phone' placeholder='üìû ‡¶´‡ßã‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞'><br>
        <input type='text' id='address' placeholder='üè† ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ'><br>
        <button id="confirmBtn" onclick='submitOrder()'>‚úÖ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ</button>
      `;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    function submitOrder() {
      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const address = document.getElementById("address").value.trim();
      const confirmBtn = document.getElementById("confirmBtn");
      if(!/^\d{11}$/.test(phone)) {
        alert("‚ö†Ô∏è ‡¶´‡ßã‡¶® ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á ‡ßß‡ßß ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá!");
        return;
      }
      if(confirmBtn){
        confirmBtn.disabled = true;
        confirmBtn.innerText = "‚úÖ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶π‡ßü‡ßá‡¶õ‡ßá";
      }
      let totalBill = offerPrices[selectedOffer] || 0;

      // ‚úÖ Google Apps Script ‡¶è ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
      fetch("https://script.google.com/macros/s/AKfycbwSDS6mHwGrfmKMX6cQYCLetfApsKENLyVMqIsc1o4t8tOgECcl4r0G1NAFhk0c8fylsA/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, phone, address, offer: selectedOffer })
      });

      // ‚úÖ ‡¶∏‡¶¨ ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú clear
      messages.innerHTML = "";
      const invoice = document.createElement("div");
      invoice.className = "invoice";
      invoice.innerHTML = `
        <h3>üßæ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ‡ßá‡¶∂‡¶®</h3>
        <p>üìç ‡¶®‡¶æ‡¶Æ: ${name}</p>
        <p>üìç ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ: ${address}</p>
        <p>üìç ‡¶´‡ßã‡¶®: ${phone}</p>
        <p>üìç ‡¶Ö‡¶´‡¶æ‡¶∞: ${selectedOffer}</p>
        <p>üìç ‡¶Æ‡ßã‡¶ü ‡¶¨‡¶ø‡¶≤: ${totalBill} ‡¶ü‡¶æ‡¶ï‡¶æ</p>
        <p>üì¢ ‡ß®/‡ß© ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßá‡¶≤ ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶π‡¶¨‡ßá‡•§ ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶ üî∞</p>
      `;
      messages.appendChild(invoice);
      orderConfirmed = true;
    }

    setTimeout(() => {
      addMessage("üßº ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶æ‡¶´‡¶∞‡¶æ‡¶® ‡¶∏‡¶æ‡¶¨‡¶æ‡¶® ‡¶õ‡ßá‡¶≤‡ßá ‡¶ì ‡¶Æ‡ßá‡¶Ø‡¶º‡ßá ‡¶â‡¶≠‡¶Ø‡¶º‡ßá‡¶á ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡•§\nüëâ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶õ‡ßá‡¶≤‡ßá ‡¶®‡¶æ‡¶ï‡¶ø ‡¶Æ‡ßá‡¶Ø‡¶º‡ßá?");
      addOptions(["‡¶õ‡ßá‡¶≤‡ßá", "‡¶Æ‡ßá‡ßü‡ßá"], true);
    }, 500);
  </script>
</body>
</html>